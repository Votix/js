!function(){var e=Array.prototype.slice.call(document.querySelectorAll('[data-lj-type="share-counter"]')),t="https://www.livejournal.com",n=void 0,o={},i={href:window.location.href},r=encodeURIComponent(JSON.stringify(i)),a=function(){var e=900,n=600,o=document.body,i="screenX"in window?window.screenX:window.screenLeft,a="screenY"in window?window.screenY:window.screenTop,s="outerWidth"in window?window.outerWidth:o.clientWidth,c="outerHeight"in window?window.outerHeight:o.clientHeight-22,d=Math.floor(i+(s-e)/2),u=Math.floor(a+(c-n)/2.5),w=["width="+e,"height="+n,"left="+d,"top="+u,"scrollbars"],l=t+"/post/?extShare="+r+"&owner_post_version=1";window.open(l,"_blank",w.join(", "))};o.doShare=a,e.forEach(function(e){t=e.getAttribute("data-lj-siteroot")||t;var n=t+"/post/?extShare="+r+"&owner_post_version=1";e.href=n,e.addEventListener("click",function(e){e.preventDefault(),a()})});var s=void 0;"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?s=Promise:!function(){var e=function t(e){var n=[],o=!1,i=void 0;this.then=function(e){return o?void e(i):void n.push(e)},this.resolve=function(e){return new t(function(t){t(e)})};var r=function(e){n.forEach(function(t){o=!0,i=e,t(i)})};return e(r),this};s=e}();var c=void 0,d=new s(function(e){var n=new XMLHttpRequest;n.open("GET",t+"/tools/endpoints/sessionlesstoken/"),n.withCredentials=!0,n.send(),n.onload=function(){c=n.response,e(c)}}),u=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return new s(function(o){d.then(function(){var i=new XMLHttpRequest;i.open("POST",t+"/__api/"),i.responseType="text",i.setRequestHeader("Content-type","text/plain");var r=[{jsonrpc:"2.0",method:"post.get_minipage_widget_counter",id:null,params:{url:e.href||window.location.href,auth_token:c}}],a=JSON.stringify(r);i.send(a),i.onload=function(){n=0;try{var e=JSON.parse(i.response);n=e[0].result.count}catch(t){}o(n)}})})};o.getShareCount=u;var w=u();w.then(function(t){e.forEach(function(e){var n=e.querySelector(".lj-share-widget-counter");if(n){var o=void 0,i=JSON.parse(e.getAttribute("data-lj-ml"));o=i["counter.noShares"],0===+t&&o?n.textContent=o:n.textContent=t}})}),window.LiveJournalUtils=o}();
